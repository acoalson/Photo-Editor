package edu.hmc.photo.filter;

import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertTrue;

import java.awt.image.BufferedImage;

import org.junit.Test;

import edu.hmc.photo.testUtil.ImageTest;

public class SeamTableTests extends ImageTest {
  private void testTable(String inputFilename, int[][] correctTable) {
    BufferedImage input = loadImage(inputFilename);
    FindSeam filter = new FindSeam();
    BufferedImage actual = filter.filter(input);
    assertTrue(isEqual(actual, input));
    assertTrue(isEqual(input, input));
    int[][] actualTable = filter.getTable();
    assertArrayEquals(actualTable, correctTable);
  }
  
  @Test
  public void testTiesTable() {
    int[][] correctTable = { { 150, 250 }, { 50, 100 }, { 50, 100 }, 
        { 50, 200 }, { 150, 300 }, { 50, 200 } };
    testTable("Ties.png", correctTable);
  }
  
  @Test
  public void testTies2Table() {
    int[][] correctTable = { { 0, 0 }, { 50, 150 }, { 150, 300 }, { 50, 50 }, 
        { 100, 100 }, { 50, 50 } };
    testTable("Ties2.png", correctTable);
  }
  
  @Test
  public void testMicroTable() {
    int[][] correctTable = { { 20, 60, 50, 90, 140 }, { 10, 30, 80, 90, 150 }, 
        { 20, 70, 120, 100, 130 } };
    testTable("Micro.png", correctTable);
  }
  
  @Test
  public void testTinyTable() {
    int[][] correctTable = { { 0, 7, 14, 14, 14, 14 }, { 0, 7, 7, 14, 14, 14 }, 
        { 0, 7, 7, 14, 14, 7 }, { 0, 7, 7, 14, 7, 7 }, { 0, 7, 7, 0, 7, 14 }, 
        { 0, 14, 0, 7, 7, 14 }, { 7, 0, 7, 7, 14, 14 }, { 7, 7, 7, 14, 21, 21 },
        { 7, 7, 14, 21, 14, 14 }, { 7, 7, 14, 28, 21, 14 } };
    testTable("Tiny.png", correctTable);
  }
  
  @Test
  public void testBirdSmallTable() {
    int[][] correctTable = {{27, 28, 59, 53, 69, 74, 76, 80, 93, 114, 129, 123, 132, 162, 166, 183, 207, 225, 229, 230}, 
        {11, 37, 38, 55, 58, 68, 74, 83, 89, 105, 115, 120, 133, 176, 185, 179, 203, 220, 222, 243}, 
        {38, 48, 45, 42, 55, 59, 67, 75, 92, 100, 110, 126, 145, 160, 186, 200, 202, 211, 242, 244}, 
        {21, 45, 67, 50, 44, 52, 71, 94, 110, 105, 142, 147, 142, 179, 212, 215, 224, 225, 232, 252}, 
        {31, 39, 63, 68, 74, 51, 67, 100, 144, 145, 138, 194, 205, 208, 230, 219, 298, 250, 251, 252}, 
        {7, 35, 47, 60, 75, 91, 82, 99, 120, 226, 168, 184, 207, 248, 233, 290, 239, 245, 245, 232}, 
        {10, 13, 22, 40, 55, 72, 66, 83, 159, 185, 226, 223, 206, 226, 251, 215, 220, 223, 217, 197}, 
        {11, 14, 21, 27, 34, 38, 67, 219, 116, 144, 178, 296, 275, 224, 205, 209, 206, 203, 186, 186}, 
        {3, 9, 10, 27, 40, 66, 208, 102, 274, 163, 254, 278, 217, 180, 186, 184, 175, 174, 171, 164}, 
        {8, 7, 16, 23, 28, 141, 105, 324, 187, 183, 126, 175, 167, 185, 171, 145, 166, 161, 154, 176}, 
        {5, 14, 12, 24, 29, 118, 148, 192, 119, 90, 94, 114, 123, 148, 141, 171, 155, 139, 149, 152}, 
        {4, 20, 22, 22, 34, 41, 51, 60, 66, 69, 92, 119, 121, 132, 144, 143, 125, 140, 161, 161}, 
        {4, 14, 14, 22, 28, 35, 47, 55, 76, 80, 104, 88, 97, 114, 134, 110, 115, 137, 140, 150}, 
        {5, 6, 12, 20, 34, 39, 49, 63, 57, 63, 80, 106, 111, 95, 103, 118, 123, 123, 135, 146}, 
        {1, 12, 15, 28, 38, 46, 51, 55, 61, 72, 85, 93, 89, 112, 118, 113, 128, 152, 135, 145}, 
        {7, 3, 15, 36, 57, 59, 67, 66, 66, 72, 97, 85, 86, 114, 89, 106, 114, 125, 137, 117}, 
        {9, 17, 23, 40, 43, 46, 51, 57, 60, 65, 71, 66, 68, 75, 93, 89, 103, 111, 106, 104}, 
        {6, 10, 14, 22, 31, 43, 52, 52, 56, 69, 57, 58, 65, 67, 79, 85, 85, 92, 99, 112}, 
        {6, 18, 18, 17, 30, 39, 57, 52, 52, 56, 59, 61, 65, 84, 70, 77, 86, 98, 118, 115}, 
        {17, 11, 37, 28, 38, 52, 47, 48, 54, 55, 60, 67, 101, 93, 93, 78, 92, 91, 98, 112}, 
        {18, 42, 43, 51, 48, 57, 54, 53, 50, 54, 57, 64, 69, 79, 94, 105, 93, 100, 96, 105}, 
        {17, 32, 44, 38, 54, 50, 51, 57, 60, 58, 60, 65, 85, 74, 80, 92, 102, 107, 122, 107}, 
        {35, 32, 36, 46, 51, 62, 55, 56, 65, 62, 59, 70, 80, 97, 87, 105, 106, 118, 115, 134}, 
        {21, 39, 36, 52, 49, 70, 64, 63, 66, 67, 75, 76, 80, 88, 96, 102, 117, 133, 167, 153}, 
        {26, 46, 36, 40, 47, 57, 79, 80, 74, 91, 85, 87, 96, 92, 96, 98, 125, 135, 172, 172}, 
        {28, 16, 25, 48, 57, 59, 64, 80, 100, 112, 97, 94, 94, 99, 98, 120, 112, 122, 141, 155}, 
        {4, 24, 24, 43, 50, 54, 51, 62, 74, 74, 82, 107, 100, 110, 119, 115, 138, 130, 138, 148}, 
        {31, 18, 24, 30, 35, 42, 49, 54, 63, 72, 82, 85, 93, 100, 129, 138, 137, 156, 137, 156}, 
        {45, 68, 37, 41, 36, 39, 44, 53, 63, 74, 84, 86, 97, 108, 107, 121, 129, 154, 161, 154}, 
        {43, 87, 86, 58, 46, 39, 44, 63, 65, 82, 81, 97, 96, 112, 111, 118, 133, 145, 162, 179}};
    testTable("BirdSmall.png", correctTable);
  }
}
